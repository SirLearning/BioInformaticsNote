# 试题

## 概念

一、对于真核基因剪接位点识别这一问题，假设依据的信息为位点前后共计d个位置上的碱基序列，请回答

1. 若采用朴素贝叶斯方法，给出一种判别函数并说明需要确定的参数及其个数（4分）

   - 各位点概率相乘，共**4* d* 2+2**个参数

2. 若采用理想贝叶斯方法，给出一种判别函数并说明需要确定的参数及其个数（5分）

   - ln(前验概率* 条件概率密度)，共**4^d* 2+2**个参数

3. 比较上述两种方法的优缺点并给出一种与之不同的贝叶斯方法（10分）

   - 半朴素贝叶斯

4. 若采用 WMM 方法，给出一种判别函数并说明需要确定的参数及其个数（5分）

   - ln(位点概率/背景概率)，共**4* d* 2**个参数

5. 若采用 WAM 方法，给出一种判别函数并说明需要确定的参数及其个数（5分）

   - 共**[4^2* (d-1)+4]* 2**

6. （4）以上三种方法得到的预测效果会是什么关系，为什么？（6分）

   - 根据特征之间关系的考虑程度：

   - 理想贝叶斯>SVM、HMM、ANN>贝叶斯网络>WAM>朴素贝叶斯、WMM

7. 比较上述方法的优缺点并给出一种与之不同的贝叶斯方法（8分）

   1. WMM
      1. 优点：方法简单，涉及的参数少，便于计算和训练；
      2. 缺点：将每个位置出现碱基的概率都考虑为独立的，未考虑之间的相关性，不太符合实际。
   2. WAM
      1. 优点：考虑到相邻碱基之间的依赖性，引入条件概率分布，方法相对简单，涉及的参数也不是很多；
      2. 缺点：仅仅考虑相邻碱基之间的依赖性，忽略了长程关联，在预测时效果也不会太理想。
   3. 理想贝叶斯方法
      1. 优点：考虑到特征之间可能存在的所有依赖性的关系，并将其每种组合都列出概率分布，误差小，预测性能好；
      2. 缺点：参数太多，导致后验概率种类过多，数据量庞大，计算不便。
   4. 另可采用朴素贝叶斯方法，原理与理想贝叶斯相似，但在处理条件概率分布时认为给定类别下特征向量是条件独立的，即P(*x*1,…,*xd*|ω*i*)=∏*s*=1,..,d P(*xs*|ω*i*)，

一、给出基于最小错误率规则的两种理想贝叶斯决策函数；简述理想贝叶斯分类方法的特点与关键问题；分析WMM、WAM方法与理想贝叶斯方法的关系。（20分）

1. 特点：理论上，贝叶斯分类器具有最优的性能，即所实现的分类错误率或风险在所有可能的分类器中是最小的。但贝叶斯分类要求具备以下前提条件：类别数目已知，各个类别的先验概率以及类条件概率密度均为已知（必须是真实情况）；
2. 关键问题：对于高维特征x=[x1,…,xd]，贝叶斯定理中的似然函数（类条件概率密度或概率分布）P(x|ωi) = P(x1,…,xd|ωi)是一个高维分布，如何有效确定该函数是实现贝叶斯分类的关键问题。
3. WMM、WAM方法是理想贝叶斯方法的简化版本，具体来说，WMM是理想贝叶斯最简化的版本，完全不考虑每个特征之间的联系；WAM也是理想贝叶斯简化的版本，但是考虑了相邻特征之间的联系。

**一、**对于贝叶斯分类，请简要回答以下问题：

1. 贝叶斯分类的基本思想是什么？（5分）

   1. 已知类条件概率密度参数表达式和先验概率
   2. 利用贝叶斯公式转换成后验概率
   3. 根据后验概率大小进行决策分类

2. 叶斯分类的关键问题是什么? （5分）

   对于高维特征x=[x1,…,xd]，贝叶斯定理中的似然函数（类条件概率密度或概率分布）P(x|ωi) = P(x1,…,xd|ωi)是一个高维分布，如何有效确定该函数是实现贝叶斯分类的关键问题。

3. 理想贝叶斯、朴素贝叶斯和贝叶斯网络方法各有何优点？（10分）

   1. 理想贝叶斯：理论上，贝叶斯分类器具有最优的性能，即所实现的分类错误率或风险在所有可能的分类器中是最小的
      1. 但贝叶斯分类要求具备以下前提条件：类别数目已知，各个类别的先验概率以及类条件概率密度均为已知
   2. 朴素贝叶斯：参数少，可以实现，简洁
      1. 但是效果不佳
   3. 贝叶斯网络：有用的参数、关系就保留，无用的参数就丢弃，效果会增加；

## SVM

二、对于上题中的问题，现改用支持向量机（ SVM ）方法建立预测模型，请简要回答

1. 线性支持向量机的优化目标是什么？（5分）

   对n个观测样本，找到最优的分类平面

2. 核函数的作用是什么，核函数如何选择？核函数的参数如何确定？（6分）

   将样本映射到新的特征空间，实现在判别函数中的分离

3. 影响支持向量机方法预测效果的主要因素有哪些？（6分）

   训练数据、核函数类型

4. 支持向量机的复杂度取决于什么？

   支持向量和错分的个数，即不为0的α的个数；

二．请设计采用SVM方法识别Donor位点的一个完整方案

1. Selection of Features 特征选择：Fragments of 12 bps around TIS 
2. Data Sets 设置数据集
3. Encoding the sequence 编码序列： A:(1,0,0,0); G:(0,1,0,0); C:(0,0,1,0); T:(0,0,0,1)
4. Selecting Kernel function 选择核函数
   1. 核函数作用：避免了直接在新的超高维平面设计支持向量机的麻烦；做了一个隐含的映射，避免了显性的映射；
   2. 类型和参数的确定：尝试，选择效果最好的
5. Designating Parameters 设计参数

实际应用中支持向量机方法的潜力主要受哪些因素制约？

- 对大规模训练样本难以实施、解决多分类问题存在困难

**二．**请根据“利用支行向量机方法预测真核基因剪接位点”这一综合训练内容简要回答以下问题： 

1.  (1) 所采用的特征向量的维数是多少（4分）

   碱基分布：4

2.  (3) 线性支持向量机的优化目标（准则函数）是由哪两部分组成的？（4分）

   第一部分是经验风险最小；第二部分是推广能力最大

3.  (4) 支持向量机方法解决线性不可分问题的思路是什么？（4分） 

   映射到更高维的特征空间，使其可分。

4.  (5) 支持向量的个数与用于训练支持向量机的样本数之间是什么关系？（4分） 

   支持向量的个数远小于用于训练支持向量机的样本数

## ANN

三、对于上题中的问题，现采用单隐层前馈神经网络建立预测模型，请简要回答

1. （1）模型的输入层和输出层分别有多少个节点？（5分）

   输入层有d个，输出层有1个

2. （2）隐层的作用是什么？隐层节点数如何确定？（7分）

   1. 作用：为了是模型能够执行和学习任何功能，对输入数据进行处理。降低网络误差（也有文献认为不一定能有效降低），提高精度，但也使网络复杂化
   2. 确定节点数：针对训练样本数确定，必须小于N-1，与需解决的问题的复杂程度和转换函数的型式以及样本数据的特性等因素有关。在满足精度要求的前提下取尽可能紧凑的结构，即取尽可能少的隐层节点数。

3. （3）该模型与上一题的 SVM 模型有哪些相同之处和不同之处？两者的预测准确性可能会是什么关系？（8分）

   1. 相同：都是映射，都属于浅层机器学习模型
   2. 不同：显性和隐性
      1. 人工神经网络是以传统统计学为基础，其研究的内容是样本数据趋于无穷多时的统计性质，适用于超大样本数据，且可轻松从二分类拓展到多分类；
      2. 支持向量机则是以统计学习理论为基础,不涉及概率测度及大数定律等，计算的复杂性取决于支持向量的数目，避免了“维数灾难”，克服了神经网络中的“过学习问题”。更适用于小样本数据，且在多分类问题上不能直接运用。

4. 实际应用中人工神经网络方法的潜力主要受哪些因素制约？

   1. 易出现“过拟合”、易陷入局部最优

## HMM

四、对于隐马尔科夫模型（ HMM ）方法，请间要回答

1. HMM 的建立与应用需要解决哪些问题？（5分）
   1. HMM的结构
   2. 估计问题：根据一个O，建立一个M，在给定M下评估该序列的概率
   3. 解码问题：找到O最可能通过M的路径Q
   4. 学习问题：根据给出的O，来对M进行优化，其中可能存在Q。确定模型M参数
2. 给出采用 HMM 方法预测蛋白质二级结构的一种模型拓扑结构，并给出该模型需要确定的参数类型与个数。（10分）
   1. 有helix、coil、strand三种状态，根据序列编码特征向量，先进行训练而后在交叉检验后，使用模型对给定蛋白质的二级结构进行预测
   2. T: 3* 20* 3=180; E: 20* 3* 20=1200，共1380个参数

请根据以下一组保守序列片断的多序列比对结果，给出：

1. 描述该保守序列片断的隐马尔可夫模型（HMM）结构图；
2. 该HMM的状态转移概率矩阵（Transition matrix）和生成概率矩阵（Emission matrix）。（15分）

四．对于如图（A）和图（B）所示的两组保守序列片断的多序列比对结果，分析各适合用什么模型描述，并简要说明理由（15分）

1. 图A：有空格，隐马尔可夫模型，存在若干个不可观测的隐状态；
2. 图B：无空格，WAM或者WMM模型或SVM或贝叶斯网络，不存在隐状态；

## 特征向量

五、当采用支持向量机或人工神经网络等方法建立分类模型对蛋白质序列的功能进行分析时，需要先选取某些特征将长度任意的蛋白质序列编码成固定长度的特征向量。请设计一种能综合考虑各氨基酸的组成情况及其在序列长度上的分布情况的编码方案，并给出最终所得到的特征向量的维数。（15分）

1. 组成：**C=20**
2. 转换：**T=20* 20**
3. 分布：**D=20* 5* 4**
4. 共500维

给出考虑氨基酸组成及其疏水性（三种）将长度任意的蛋白质序列编码为固定长度特征向量的一种方案，并给出该特征向量的维数（15分）

1. C：3 
2. T：3* 3=9 
3. D：4* 3=12（四等分）
4. 24
5. 加上氨基酸组成，共524维

## 论述题

六、如果遇到类似真核基因剪接位点识别这样的研究课题，你认为应从哪些方面开展研究。（10分）

1. 6-mer等

五．对于Donor位点预测这一问题，目前你已了解了WMM、WAM、贝叶斯网络、SVM、ANN等方法

1. 你认为这些方法的预测准确度是一个什么顺序？（5分）
   1. SVM、HMM、ANN>贝叶斯网络>wam>wmm
2. 为了进一步提高预测性能，你认为应从哪些方面开展工作。（15分）
   1. 数据，质量，数据量，优化数据集的质量，保证原始数据的正确性。
   2. 特征之间的关系，有用的，优化特征的选取。对于深度学习来说，自动选取特征是难以实现的。对于图像识别来说，原始特征就是原始数据。
   3. 更有效的先验知识，虽然关注的是donor位点，但可以站在更高的层次去研究，可以站在编码区，基因结构的层面去研究。
   4. 更强的计算能力
   5. 更好的模型结构，只考虑有用的，模型的选择：选取donor位点的模型有很多，但是没有理论告诉我们哪种模型最好。可以尝试多种模型以及多种模型的结合

六．简要总结：

1. 你在本课程上机实践训练中所完成的内容、遇到了哪些困难、思考了哪些问题；（10分）
   1. 真核基因剪接位点预测的WAM模型编程实现中：
      1. 完成了：特征的提取（选取剪接位点前3个和后4个位置碱基信息）、训练集数据的提取和表示，统计算出WAM条件概率模型（包括P+和P-，用二维数组表示）、设置初始C值对测试集数据依次滑动进行打分、计算Sn和Sp、修改C值并作出了曲线，从图中选取Sn、Sp较理想的C值
      2. 遇到的困难：如何批量读取文件并将其中的数据输入到二维数组中
   2. 利用SVM方法预测真核基因剪接位点中：
      1. 完成了特征提取与数据编码、核函数的选择（高斯核）、参数学习
      2. 遇到的困难：核函数的选取和参数的确定
2. 通过本课程的学习与训练你有哪些收获。（5分）
   1. 了解和学习了WMM、WAM、贝叶斯网络、理想贝叶斯、SVM、HMM、传统ANN、深度神经网络等数据挖掘方法，明白了这些方法的基本原理以及能逐步应用这些方法去解决一些生物信息学研究中的问题。
   2. 分析问题和解决问题的能力得到了提升，对我们生信专业有了更深层次的认识。
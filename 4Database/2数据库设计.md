[[BioInformaticsNote/4Database/README|README]]

概述
1. **专业人员应具备的技术和知识**
	- 数据库的基本知识和数据库设计技术。
	- 计算机科学的基础知识和程序设计的方法和技巧。
	- 软件工程的原理和方法。
	- 应用领域的知识。
2. **数据库设计的内容**
	- **结构设计**：确定数据库的模式。
	- **行为设计**：数据库应用系统的设计，包括模块设计、界面设计、事务的划分和编写程序代码。
3. **数据库设计的阶段**
	- **需求分析**：获取数据库设计所必需的数据信息。
	- **概念设计**：形成独立于具体DBMS和计算机硬件结构的整体概念结构。
		- 基于E-R模型方法用于概念结构设计阶段
	- **逻辑设计**：将概念模式转换为具体DBMS支持的数据模型。
		- 基于3NF的设计方法用于逻辑结构设计阶段
	- **物理设计**：为逻辑数据结构选取一个最适合应用环境的物理结构。
	- **实施和运行**：用DBMS提供的DDL和其他实用程序将设计结果实现。
	- **使用和维护**：收集和登记数据库运行的情况记录，用于评价并改善数据库系统的性能。

需求分析
1. **需求分析的任务**：获得数据库设计所必需的数据信息，即用户的要求
	- **信息要求**：设计范围内涉及的所有信息的内容、特征、需要存储的数据。
	- **处理要求**：用户对信息加工处理的要求，包括发生的频度，响应时间，批处理还是联机处理。
	- **安全性与完整性要求**：数据的安全性和完整性要求。
2. **需求分析的方法**
	- **调查用户需求**：通过访谈、问卷等方式收集用户需求。
	- **分析和表达用户的需求**：将用户需求进行分析和整理，形成需求文档。
		- **结构化分析方法**：自顶向下，逐层分解。
		- **数据流图**：表达数据和处理过程的关系，作为数据库设计专业人员和用户沟通的工具。
3. **数据字典**
	- **定义**：系统中各类数据描述的集合，是对数据收集和数据分析的详细描述。
	- **内容**：数据项、数据结构、数据流、数据存储、处理过程。
	- **实现途径**：全人工过程、全自动化过程、混合过程。
	- **特点**：通过名字能方便地查询数据的定义，较少的数据冗余，容易更新和更改，定义的书写方式简单方便且严格。

概念结构设计
1. **概念结构的定义**
	- 用户容易理解的、对现实世界特征的数据抽象，与具体的DBMS无关，是数据库设计员与用户之间进行交流的语言。
	- 常用的概念数据模型是实体-联系（E-R）模型。
2. **概念结构设计的方法与步骤**
	- **自顶向下**：从整体到局部，逐步细化。
	- **自底向上**：从局部到整体，逐步合并。
	- **逐步扩张**：从核心结构开始，逐步扩展。
	- **混合策略**：结合上述方法，灵活运用。
3. 实体-联系方法(Entity- Relationship Approach)，简称E-R方法或E-R模型，是一种概念数据模型
	- **实体**：客观存在并可相互区别的事物。
	- **属性**：实体的特征。
	- **联系**：实体之间的关系。
4. **概念模型的表示**：E-R图
	- 定义
		- 使用矩形表示实体，椭圆表示属性，菱形表示联系。
		- 实体之间的联系可以分为三类：一对一联系（1:1）、一对多联系（1:n）、多对多联系（m:n）
	- 数据抽象与局部E-R图设计：局部设计后得到各个分E-R图
		- 划分实体与属性的准则：
			- 属性不能再用属性描述，是不可再分的数据项。
			- 属性不能与其它实体有联系。
	- E-R图的集成：视图的集成是将各子系统的分E-R图综合成一个总的E-R图，
		- 分类：
			- 多个分E-R图一次集成
			- 逐步集成，如用累加的方式一次集成两个分E-R图
		- 步骤：
			1. 合并：解决各分E-R图之间的冲突，将各分E-R合成初步E-R图，冲突包括
				- 属性冲突 ：类型、取值范围、长度
					- 属性域冲突：属性值的类型、取值范围或取值集合不同
					- 属性取值单位冲
				- 命名冲突：
					- 同名异义（一名多义）：不同对象在不同的局部应用中具有相同的名字
					- 异名同义（一义多名）：同一意义的对象在不同的局部应用中具有不同的名字
				- 结构冲突：属性数、作为实体或属性
					- 同一对象在不同应用中具有不同的抽象
					- 同一实体在不同局部视图中所包含的属性不同
				- 联系类冲突：实体间的联系在不同局部视图中呈现不同的类型
			2. 消除冗余：消除不必要的冗余，生成基本E-R图

逻辑结构设计
1. **逻辑结构设计**
	- 将概念模式（E-R图）转换为具体DBMS支持的数据模型。
		- 将概念结构转换为一般的关系、网状、层状模型；
		- 将转换来的关系、网状、层状模型向特定DBMS支持下的数据模型转换；
	- 采用范式理论对数据逻辑结构进行优化。
		- 对数据模型进行优化
2. E-R图向关系模型的转换
	- 一个实体型转换为一个关系模式的转换规则： 
		- 对于E-R模式中的每个实体型，设计一个关系模式与之对应，使该关系模式包含实体型的所有属性，用下划线来表示关系模式的主键和外键所包含的属性。
	- 一个联系转换为一个关系模式的转换规则：
		- 1:1联系的转换
		- 1:n联系的转换
		- 对m:n联系的转换：一个m:n联系可以转换为一个独立的关系模式。
			- 关系的属性：与该联系相连的各实体的键以及联系本身的属性
			- 关系的键：两个实体键的组合是该关系的键
3. **数据模型的优化**
	- 根据范式理论对模型进行优化：
		- **确定数据依赖**：根据需求分析阶段所得到的语义，分别写出每个关系内部各属性之间的数据依赖、不同关系模型属性之间的数据依赖。
		- **对函数依赖进行处理**：对各个关系模式之间的数据依赖进行最小化处理，消除冗余的联系。
		- **对数据模式进行分解**：按照数据依赖的理论对关系模式逐一进行分析，考察是否存在部分函数依赖、传递函数依赖、多值依赖等，确定各关系模式分别属于第几范式。
	- **对关系模式进行分解**
		- **水平分解**：将基本元组关系的元组分解为若干子集合，以提高数据库操作的效率。
		- **垂直分解**：将关系模型R的属性分解为若干子集合，形成若干子模型。
4. **设计用户子模式（视图 View）**
	- 定义数据库子模式主要是从系统的时间效率、空间效率、易维护等角度出发。
	- 在SQL语言中，可以用创建视图来实现。

物理设计：
1. 概念：
	- 数据的物理模型：描述数据在存储介质上组织结构的数据模型，它不但与具体的DBMS有关，而且还与操作系统和硬件有关，是物理层次的数据模型
	- 物理设计：为逻辑数据结构选取一个最适合应用要求的物理结构
	- 数据库物理设计的步骤：
		1. 确定数据库的物理结构，在关系数据库中主要指存取方法和储存结构。
		2. 评估物理结构的设计，重点是时间和空间效率
2. **物理设计的内容和方法**
	- 设计原则：
		- **事务响应时间小**。
		- **存储空间利用率高**。
		- **事务吞吐率大**。
	- 数据库查询事务所需的信息：查询的关系、查询条件所涉及的属性、连接条件所涉及的属性、查询的投影属性
	- 数据更新所需的信息：被更新的关系、每一关系上的更新操作条件所涉及的属性、修改操作要改变的属性值
3. 关系模式存取方法：数据库物理设计的任务之一就是要确定选择哪些存取方法，即建立哪些存取路径
	- 主要的方法有：
		- 索引方法：主要是B+树
		- 聚簇（Cluster）方法
	- 存取方法的选择：
		- 索引存取方法的选择：确定哪些属性列建立索引、哪些属性列建立组合索引、哪些索引要设计为唯一索引等。
		- 如何确定建立索引的属性：
			- 经常查询的属性 （如：学号）
			- 经常在聚集函数中使用的属性（如：成绩）
			- 在连接条件中出现的属性 （二个关系的同名属性）
		- 存取方法的选择：索引不是越多越好，DBMS必须为索引的维护付出代价
		- 聚簇存取方法的选择：关系中指定属性值相同的元组集中存放在连续的存储块中，称为聚簇。指定属性为聚簇属性。
			- 许多关系型DBMS都提供了聚簇功能
			- 聚簇索引：
				- 性质：
					- 建立聚簇索引后，基表中数据也需要按指定的聚簇属性值的升序或降序存放。也即聚簇索引的索引项顺序与表中元组的物理顺序一致。
					- 在一个基本表上最多只能建立一个聚簇索引
				- 用途：
					- 对于某些类型的查询，可以提高查询效率：提高按聚簇属性进行查询的效率
					- 节省存储空间：聚簇以后，聚簇码相同的元组集中在一起了，因而聚簇码值不必在每个元组中重复存储，只要在一组中存一次就行了
				- 适用范围：
					- 很少对基表进行增删操作
					- 很少对其中的变长列进行修改操作
				- SQL建立聚簇表
4. 确定数据库的存储结构
	- 确定数据库的物理结构：
		- 确定数据的存放位置（根据存取频率将数据分开存放）
			- 表和索引放在不同的盘上；
			- 较大的表分别放在两个盘上；
			- 将日志文件、备份文件与数据库中的表、索引放在不同的盘上；
			- 对经常存取或存取时间要求高的对象如表、索引等放在高速存储器（磁盘）上。
		- 确定系统配置   主要参数有：
			- 同时使用数据库的用户数；
			- 同时打开的数据库对象数；
			- 存储分配参数、物理块大小、装填因子、时间片大小、数据库大小、锁的数目等
	- 评价物理结构：
		- 主要考虑的因素：存取时间、存储空间利用率、维护代价、数据可恢复性。这几方面常常相互矛盾，需要折中选择。

三类数据模型在数据库设计过程中的应用
- 首先，数据库设计人员根据用户的实际情况，将现实世界的数据特征抽象为概念数据模型，当确认该模型真实地描述了企业实际情况之后，数据库设计人员将概念模型转化为数据库管理系统（DBMS）支持的某一个结构数据模型，并利用DBMS提供的数据定义语言（DDL）将其书写为程序源码，DBMS将其转化为数据库目标模式，并在OS支持下自动将其转换为物理模型，并按物理数据库模型规定的格式将其存放在外存储介质上，形成数据库文件。

数据库的实施
1. 用DDL定义数据库结构：使用DBMS提供的DDL和其他实用程序将逻辑结构设计和物理设计结果实现
2. 组织数据入库：调试产生目标模式，将数据装入数据库
	- 数据的载入：录入或从旧系统转换而来
3. 应用程序的编码和调试：应与数据库设计同时进行，结合已经载入的数据进行调试
4. 数据库试运行
	- 在原有系统的数据有一小部分已输入数据库后，就可以开始对数据库系统进行联合调试，称为数据库的试运行
		- 测试应用程序功能是否满足设计要求 
		- 测试系统性能是否与设计目标相符
	- 注意事项：
		- 分批组织数据入库，防止修改设计时需要大量修正数据或是数据作废
		- 做好系统的备份工作
5. 在数据库运行阶段，DBA的工作
	- 数据库的转储和恢复
	- 数据库的安全性、完整性控制
	- 数据库性能的监督、分析和改造：性能调整或数据库重构
	- 数据库的重组织与重构造
		- 重组织：改变数据的存放位置
			- 数据库运行一段时间后，由于记录的不断增、删、改，会使数据库的物理存储变坏，从而降低数据库存储空间的利用率和数据的存取效率，使数据库的性能下降
			- 重组织的工作：
				- 按原设计要求
					- 重新安排存储位置
					- 回收垃圾
					- 减少指针链
				- 数据库的重组织不会改变原设计的数据逻辑结构和物理结构
		- 重构造：修改模式、外模式或
			- 数据库应用环境发生变化，会导致实体及实体间的联系也发生相应的变化，使原有的数据库设计不能很好地满足新的需求
				- 增加新的应用或新的实体
				- 取消某些已有应用
				- 改变某些已有应用
			- 重构造的主要工作：根据新环境调整数据库的模式和内模式
				- 增加新的数据项
				- 改变数据项的类型
				- 改变数据库的容量
				- 增加或删除索引
				- 修改完整性约束条件

数据库系统的模式结构
1. **数据库系统的三级模式结构**：模式（SCHEMA），是‘型’的概念
	- **模式**：逻辑模式，描述数据库的逻辑结构。
	- **外模式**：子模式，用户视图，描述用户的数据视图。
	- **内模式**：存储模式，物理模式，描述数据的物理存储结构。
2. **二级映象功能与数据独立性**：三级模式之间的两级映象
	- **外模式/模式映象**：当模式发生改变时，外模式可以保持不变，从而应用程序可以保持不变，实现数据的逻辑独立性。
	- **模式/内模式映象**：当数据库的存储结构发生变化（内模式变化）时，可以仅仅改变模式/内模式映象而使模式维持不变，从而应用程序可以保持不变，实现数据的物理独立性。

数据库管理系统
1. **数据库管理系统的功能**
	- **数据库定义**（DDL）：CREATE DATABASE、CREATE TABLE、CREATE VIEW。
	- **数据操纵**（DML）：SELECT、INSERT、UPDATE、DELETE。
	- **数据库控制**：确保多用户的访问互不影响。
	- **数据库维护**：初始数据的装入、数据库的转储或后备功能、数据库恢复功能、数据库的重组织功能以及性能分析等功能。
2. **数据库管理系统（DBMS）的组成**
	- **数据和元数据存储**：存储数据和元数据。
	- **查询处理器**：包括编译器、解释器和预编译器。
	- **存储管理器**：包括文件管理器和缓冲区管理器。
	- **事务管理器**：确保事务的ACID属性。
	- **输入模块**：处理模式修改、查询和修改请求。
3. **常见的关系数据库系统**
	- Oracle
	- Microsoft SQL Server
	- IBM DB2 和 Informix
	- MySQL
	- Sybase ABE
	- Microsoft Access、Visual FoxPro
	- **四大数据库的比较**：
		- **开放性**：SQL Server 只能在Windows上运行，Oracle 和 Sybase 能在所有主流平台上运行。
		- **可伸缩性和并行性**：Oracle 和 DB2 在处理大数据和高并发方面表现较好。
		- **性能**：Oracle 和 DB2 通常性能更优。
		- **客户端支持及应用模式**：Oracle 和 SQL Server 提供丰富的客户端工具和应用模式。
		- **操作简便性**：SQL Server 和 Access 操作更为简便。
4. 数据库编程：利用RDBMS提供的SQL语言编写直接存放在数据库服务器上某个数据库中的例行程序，这个程序可以由客户端的应用程序调用，其目的是提高数据处理效率或保证数据的完整性
	- TANSACT-SQL：它是Microsoft实现的SQL Server的核心组件，是对标准SQL语言的扩充
	- 存储过程：SQL语句的集合，它经预先编译后存储在数据库中，并能通过应用程序调用使其在数据库服务器上直接运行。
	- 存储过程的优点：存储过程与在本地机上的TRANSACT-SQL程序相比较的其优点是
		- 存储过程允许模块化编程。
		- 存储过程运行的速度更快。
		- 存储过程使网络流量降低以及在加密状态下运行
	- 触发器：一种特殊的、附着在某个基本表上的存储过程，它保证在记录的插入、修改和删除时能够执行与该基本表有关的特定操作，一般用来维护数据的一致性。
		- 触发器运行方式：由于触发器附着在某个基本表上，且通常都定义了触发的条件。当该基本表的插入、修改和删除操作发生时，系统都会自动检查触发器的条件，如果满足条件，则执行触发器，否则触发器不被执行。
		- 触发器定义规则： 一个表最多可以定义三个触发器，而一个触发器只能作用于一个表上，但是可以响应三个用户动作：更新、插入、删除。
